# მოდულები
<p class="uk-article-lead">აპლიკაციების პროგრამული კოდისათვის Pagekit-ი იყენებს *მოდულებს*. მოდულის აგებისას გამოიყენება პირველადი ჩატვირთვის, მარშრუტიზაციის და სხვა საკონფიგურაციო ოპციები. აქ თქვენ შეგიძლიათ დაწეროთ მოვლენები, დაამატოთ საკუთარი კლასები და კონტროლერები.</p>

## განსაზღვრება: index.php
იმისათვის, რომ ჩატვირთოს ან დააკონფიგურიროს მოდული, Pagekit-ს აქვს მენეჯერი -  ModuleManager. ის უყურებს  `index.php` ფაილს მოდულის ძირეულ დირექტორიაში და ელოდება მისგან  PHP მასივის დაბრუნებას. ჩათვალეთ, რომ მოდულის ჩავირთვიათვის ეს მასივი უპირველესია.

ამ მასივში თვისებების სწორად დაწერით, თქვენ ეუბნებით Pagekit-ს ყველაფერს, თუ რა უნდა იცოდეს ამ მოდულის შესახებ.

```php
<?php

/*
 * აბრუნებს მოდულის განმსაზღვრელ მასივს.
 */
return [

    // Required: Unique module name
    'name' => 'hello',

];
```

ეს არის მოდულის სწორად აღწერის მინიმალური მაგალითი, მაგრამ ის არაფერს არ აკეთებ, გარდა იმისა რომ ჩატვირთული იქნება  Pagekit-ის მიერ. მოდული იტვირთება მხოლოდ მაშინ, თუ ის ჩართულია ატმინისტრატორის მართვის პანელიდან.

**შენიშვნა:** თუ გადახედავთ If you start exploring Pagekit-ის შინაგან სტრუქტურას, ასეთ მოდულის კონსტრუქციას თქვენ მრავალ ადგილას შეხდებით, ესაა Pagekit-ის არქიტექტურის ძირითადი კონცეფცია.

### **main**: Bootstrap (პირველი ჩატვირვის) კოდი
Theფუნქცია `main` იძახება, როცა იტვირთება მოდული. მას პარამეტრის სახით გადაეცემა  Pagekit-ის აპლიკაციის კონტეინერის ეგზეპლიარი.

```php
use Pagekit\Application;

// ...

'main' => function (Application $app) {
    // ჩასატვირთი კოდი
}
```

თქვენ ასევე, შეგიძლიათ ჩატვითოთ მოდულის კლასი. საკუთარი სახელთა სივრცის ჩატვითვა აუცილებელია მისი მუშაობისათვის. (იხ. `autoload` თვისება). აგრეთვე საჭიროა, რომ კლასმა გააკეთოს `Pagekit\Module\ModuleInterface` რეალიზება.

```php
'main' => 'MyNamespace\\MyExtension',
```

### **autoload**: საკუთარი სახელთა სივრცის რეგისტრაცია
Pagekit-ის მიერ მოხდება ავტომატური ჩატვირთვა გადაეცემული სახელების და გზების სიისა. არსებული კლასები ხელმისაწვდომი უნდა იყოს ავტოჩამტვირთველისათვის (`use Pagekit\Hello\HelloExtension`). ფაილების განთავსების გზები ეფარდება მოდულის განთავსებას.

```php
'autoload' => [

    'Pagekit\\Hello\\' => 'src'

]
```

### **routes**: კონტროლერების მიერთება
Use the `routes` თვისების გამოყენებით ხდება კონტროლერების მასშუტზე მიერთება. წაიკითხეთ მეტი ამის შესახებ  [მარშრუტიზაცია და კონტროლერები](routing.md).

```php
'routes' => [

    '/hello' => [
        'name' => '@hello/admin',
        'controller' => [
            'Pagekit\\Hello\\Controller\\HelloController'
        ]
    ]

]
```

### **permissions**: დაშვებების განსაზღვრა
თქვენს მოდულს შეუძლია განსაზღვროს დაშვებები. მათი მართვა შესაძლებელია  Pagekit User & Permissions არედან. თქვენ შეგიძლიათ დაიცვათ თქვენი მარშუტები ან დააწესოთ გარკვეული არასანქცირებული მოქმედებების აკრძალვა მომხმარებლების მრიდან.

```php
'permissions' => [

    'hello: manage settings' => [
        'title' => 'Manage settings'
    ]

]
```

### **resources**:რესურსების რეგისტრაცია მოკლე სახელებით
შეიძლება პრეფიქსების რეგირტრაცი, რამელიც გამოიყენება, როგორც მოკლე ვერსია ფაილების სრული გზისა. მაგალითისთვის გამოიყენება `views:admin/settings.php` რათა მივწვდეთ `packages/VENDOR/PACKAGE/views/admin/settings.php`ფაილს. Pagekit-ს თავის მხრივ, გაფართოებებისათვის და თემებისათვის,  უკვე რეგისტრირებული აქვს რამოდენიმე გზა.

ეს მუშაობს, როცა იყენებთ Pagekit-ის ფაილურ სისტემას(ე. ი. როცა ხდება ფაილის გზისთვის  url-ის ან კონტროლერიდან რომელიმე ხედის დარენდერების გენერაცია).

```php
'resources' => [

    'views:' => 'views'

],
```

### **events**: Pagekit-ის ან სხვა მოდულების მოვლენების მოსმენა
მოვლენები გამოიძახება Pagekit-ის ბირთვის რამოდენიმე წერტილში და პოტენციურად სხვა მოდულების მიერ. მოვლენას ყოველთვის აქვს მისი მაიდენტიფიცირებელი უნიკალური სახელი. შესაძლებელია უკუგამოძახების ფუნქციის რეგისტრაციაც.

მეტი ინფორმაციისავის მოვლენების სისტემაზე დააკლიკეთ [Events section](../developer-basics/architecture-events.md)

```php
'events' => [

    'view.scripts' => function ($event, $scripts) {
        $scripts->register('hello-settings', 'hello:app/bundle/settings.js', '~extensions');
    }

]
```

### **config**: მოდულის ძირითადი კონფიგურიაცია
ესენია მოდულის ძირითადი საკონფიგურაციო ცვლადები.

```php
'config' => [
    'default' => 'World'
],
```

#### config-ის წაკითხვა
მოდულის კონფიგურაციის წაკითხვა შესაძლებელია `config` თვისებით module-ს ეგზეპლიარიდან. ეს არის შედეგი ორი config-ის რაც გაწერილია  `index.php` ფაილში და შენახულია მონაცემთა ბაზაში.

```php
$config = $app->module('hello')->config;
```

#### კონფიგურაციის ჩაწერა
მოდულის კონფიგურაციის ცვლილების ჩასაწერად გამოიყენება  `config()` სერვისი. ყველა ცვლილება ავტომატურად იწერება მონაცემთა ბაზაში.

```php
// კონფიგურაციის დასრულება
$app->config()->set('hello', $config);

// ერთი ცვლადი
$app->config('hello')->set('message', 'Custom message');
```

**შენიშვნა**. თუ კონფიგურაციას წაიკითხავთ მაშინვე მოდულიდან, ის შეიძლება იყოს ძველი მნიშვნელობა. შემდეგ შეკვეთაზე ხდება სინთეზი ცვლილებიდან და ხელმისაწვდომია  `config` თვისებით  `$module`-ს ეგზეპლარიდან.

### **nodes**: საიტის ხის კვანძების რეგისტრაცია
კვანძები მსგავსია მარშრუტების, იმ განსხვავებით, რომ საიტის ხის სტრუქტურაში მათი გადანაცვლება შესაძლებელია, რაც მათ დინამიური მარშუტის სახეს აძლევს.

კვანძის დამატებისას ის ხელმისაწვდომი ხდება საიტის ხისთვის. _Add Page_ ღილაკზე დაჭერით შეიძლება ნახვა, თუ რა კვანძებია რეგირტრირებული.

კვანძების შესახებ მეტი ინფორმაციას წაიკითხავთ  [Routing section](../developer-basics/routing.md) ბმულზე

```php
'nodes' => [

    'hello' => [

        // node მარშუტის სახელი
        'name' => '@hello',

        // რაც უნდა გამოჩნდეს სამართავ პანელში
        'label' => 'Hello',

        // ამ კვანძის კონტროლერი. მიებმება კონტროლერის ყველა აქტივობა
        'controller' => 'Pagekit\\Hello\\Controller\\SiteController'
    ]

]
```

### **menu**: ადმინ პანელში ამატებს მენიუს პუნქტებს
შესაძლებელია მენიუების ჩამატება საიტის ასმართავ პანელში. ისინი შეიძლება დაკავშირდეს რეგისტრირებულ მარშუტებთან და შემოსაძღვრულია გარკვეულ დავშვების უფლებებით.  `access` თვისება განსაზღვრავ, გამოჩნდება თუ არა მენიუს პუნქტი.

```php
'menu' => [

        // სახელი, შესაძლებელი გამოყენებული იქნას მენიუს იერარქიისავის 
        'hello' => [

            // რაც ეკრანზე ჩნდება
            'label' => 'Hello',

            // პიკტოგრამა ეკრანზე
            'icon' => 'hello:icon.svg',

            // ამ მენიუს URL-ი
            'url' => '@hello/admin',

            // Optional: გაფართოება ამოწმებს, მენიუ თუ აქტიურია ამ ბმულისათვის 
            // 'active' => '@hello*'

            // Optional: ლიმიტირებული დაშვეა როლებთან, რემლებიც განსაზღვრავენ სპაციალურ დაშვებას
            // 'access' => 'hello: manage hellos'
        ],

        'hello: panel' => [

            // წინაპარი მენიუს პუნქტი makes this appear on 2nd level
            'parent' => 'hello',

            // იხ. მაღლა
            'label' => 'Hello',
            'icon' => 'hello:icon.svg',
            'url' => '@hello/admin'
            // 'access' => 'hello: manage hellos'
        ]

    ],
```

### **settings**: პარამეტრების გვერდზე გადასვლა
მარშუტი, რომელსაც გადავყევართ  პარამეტრების გვერდზე. ამ პარამეტრის დაყენებით  Pagekit-ს თემის ან გაფართოების სამართავ პანელში გამოაქვს  _Settings_ ღილაკი.

```php
'settings' => '@hello/admin/settings',
```

### **widgets**: ვიჯეტის რესიგსტრაცია
ვიჯეტი აგრეთვე მოდულია. `widgets` თვისების საშუალებით შესაძლებელია დავარეგისტრიროთ ვიჯეტის განმსაზღვერელი ყველა ფაილი. რომელაგან ყოველი აბრუნებს PHP მასივს მოდულის აღწერის ფორმატში. უფრო მეტის სწავლა შეიძლება ბმულზე -  [ვიჯეტები](../developer-guides/widgets.md).

```php
'widgets' => [

    'widgets/form.php'

],
```

## Module config

```
TODO
```
